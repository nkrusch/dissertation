name: Test

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

on:
  schedule:
    - cron:  '0 0 1 * *'
  workflow_dispatch:
    branches: [ main ]
  push:
    branches: [ main ]

jobs:
  exec_test:
    name: Runtime test
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4
      - name: üê≥ Use Docker Engine on Ubuntu
        uses: addnab/docker-run-action@v3
        with:
          registry: gcr.io
          image: nkrusch/dissertation:artifact
          options: platform=linux/amd64
          shell: bash
          run: |
              pymwp --info examples/original_paper/example3_1_b.c
              cd code && coqc equiv.v && dafny verify equiv.dfy